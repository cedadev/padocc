
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PADOCC Command Line Tool &mdash; PADOCC Package v1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=45183d27"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extra Details for CEDA Staff" href="ceda_staff.html" />
    <link rel="prev" title="Basic User Guide" href="user_guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PADOCC Package
              <img src="../_static/padocc_wt.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="inspiration.html">Inspiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">PADOCC Terms and Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing PADOCC</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">Basic User Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Command Line Tool Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basics-of-the-cli">Basics of the CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-command-form">General Command Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="#group-operation-flags">Group operation flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phased-operation-flags">Phased operation flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#all-non-phased-operations">All Non-Phased Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add">Add</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complete">Complete</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-log">Get Log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#repeat">Repeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transfer">Transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-status">Update Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aggregations">Aggregations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-set-attributes">Check/Set Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete">Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new">New</a></li>
<li class="toctree-l3"><a class="reference internal" href="#report">Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summarise">Summarise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ceda_staff.html">Extras for CEDA Staff</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Detailed View:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../detailed/features.html">Bespoke Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detailed/parallel.html">Parallel Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detailed/shepard.html">SHEPARD Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PADOCC API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source_code/project_source.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_code/group_source.html">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_code/shepard_source.html">SHEPARD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_code/phase_source.html">Phases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_code/misc_source.html">Filehandlers, Logs, and Utilities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PADOCC Package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">PADOCC Command Line Tool</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/core/cli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="padocc-command-line-tool">
<h1>PADOCC Command Line Tool<a class="headerlink" href="#padocc-command-line-tool" title="Link to this heading"></a></h1>
<img alt="Stages of the PADOCC workflow" src="../_images/pipeline.png" />
<p>The command-line tool <code class="docutils literal notranslate"><span class="pre">padocc</span></code> allows quick deployments of serial and parallel processing jobs for your projects and groups within the padocc workspace. The core phases are most readily executed using the command line tool.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For information on how to setup the padocc environment, please see the Installation section of this documentation. Some general tips would be to:</p>
<ol class="arabic simple">
<li><p>Ensure you have the padocc package installed and the command line tool is accessible. You can check this by running <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">padocc</span></code> in your terminal.</p></li>
<li><p>Set the working directory <code class="docutils literal notranslate"><span class="pre">WORKDIR</span></code> environment variable. All pipeline directories and files will be created under this directory, which includes all the groups you define. It is suggested to have only one working directory where possible, although if a distinction is needed for different groups of datasets, using multiple working directories can be done with user discretion.</p></li>
</ol>
</div>
<section id="basics-of-the-cli">
<h2>Basics of the CLI<a class="headerlink" href="#basics-of-the-cli" title="Link to this heading"></a></h2>
<section id="general-command-form">
<h3>General Command Form<a class="headerlink" href="#general-command-form" title="Link to this heading"></a></h3>
<p>The general form of a command for padocc should be to call the command line tool <code class="docutils literal notranslate"><span class="pre">padocc</span></code> with a minimum of the <code class="docutils literal notranslate"><span class="pre">operation</span></code> argument specified afterwards. To see all possible operations, use the <code class="docutils literal notranslate"><span class="pre">-h</span></code> or <code class="docutils literal notranslate"><span class="pre">--help</span></code> option for padocc:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>-h

<span class="go">usage: padocc [-h] {add,logs,status,compute,complete,repeat,transfer,update_status,list,summarise,check_attr,set_attr,delete,pfunc,report,new,init,scan,validate} ...</span>

<span class="go">Run PADOCC commands or pipeline phases</span>

<span class="go">positional arguments:</span>
<span class="go">{add,logs,status,compute,complete,repeat,transfer,update_status,list,summarise,check_attr,set_attr,delete,pfunc,report,new,init,scan,validate}</span>
<span class="go">    add                 Add projects to an existing group.</span>
<span class="go">    logs                Obtain logs from a given project or group.</span>
<span class="go">    status              Get a general status display for a given group.</span>
<span class="go">    compute             Compute data aggregations for a project, group or subset of projects. (Pipeline phase 2)</span>
<span class="go">    complete            Complete projects from a group or the entire group - transfer reports and data files.</span>
<span class="go">    repeat              Subset projects from a group for reanalysis or repeating a phase of the pipeline.</span>
<span class="go">    transfer            Transfer projects between groups.</span>
<span class="go">    update_status       Manually update the status of one or more projects matching conditions.</span>
<span class="go">    list                List groups in the current working directory. (WORKDIR)</span>
<span class="go">    summarise           Obtain a data summary for a given group.</span>
<span class="go">    check_attr          Check the value of an attribute across all group projects.</span>
<span class="go">    set_attr            Set the value of an attribute across all group projects.</span>
<span class="go">    delete              Delete projects from a group or the entire group.</span>
<span class="go">    pfunc               Perform a custom function across a group</span>
<span class="go">    report              Obtain the validation report for a given project, or a combined report for a group.</span>
<span class="go">    new                 Create a new empty group (to be filled with projects).</span>
<span class="go">    init                Initialise a new/existing empty group from an input file.</span>
<span class="go">    scan                Scan a project, group or subset of projects. (Pipeline phase 1)</span>
<span class="go">    validate            Validate data aggregations for a project, group or subset of projects. (Pipeline phase 3)</span>

<span class="go">options:</span>
<span class="go">-h, --help            show this help message and exit</span>
</pre></div>
</div>
<p>Help pages are also available for each operation, describing all parameters applicable to each operation as well.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>list<span class="w"> </span>-h

<span class="go">usage: padocc list [-h] [-w WORKDIR]</span>

<span class="go">options:</span>
<span class="go">-h, --help            show this help message and exit</span>
<span class="go">-w WORKDIR, --workdir WORKDIR</span>
<span class="go">                        Working directory for pipeline</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The working directory (WORKDIR) argument is universal, meaning that it is required for all PADOCC operations. It is not however a required parameter for the CLI argument parser, as the working directory can instead be picked up from the <code class="docutils literal notranslate"><span class="pre">WORKDIR</span></code> environment variable, as is convenient when performing multiple operations.</p>
</div>
<p>Four classifications are applied to the operations, which affect the different arguments accepted by each.
- Universal operations (cross-group), <code class="docutils literal notranslate"><span class="pre">list</span></code> is the only example.
- Group operations (in-group), all other operations.
- Phased operations (part of the pipeline), <code class="docutils literal notranslate"><span class="pre">scan</span></code>, <code class="docutils literal notranslate"><span class="pre">compute</span></code> and <code class="docutils literal notranslate"><span class="pre">validate</span></code>.
- Input-based operations (input file can be supplied), <code class="docutils literal notranslate"><span class="pre">add</span></code>, <code class="docutils literal notranslate"><span class="pre">init</span></code> and <code class="docutils literal notranslate"><span class="pre">validate</span></code>.</p>
</section>
<section id="group-operation-flags">
<h3>Group operation flags<a class="headerlink" href="#group-operation-flags" title="Link to this heading"></a></h3>
<p>These are the flags associated with all group-based operations (everything except <code class="docutils literal notranslate"><span class="pre">list</span></code>).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">options:</span>
<span class="go">-h, --help            show this help message and exit</span>
<span class="go">-G GROUPID, --groupID GROUPID</span>
<span class="go">                        Group identifier label</span>
<span class="go">-s SUBSET, --subset SUBSET</span>
<span class="go">                        Size of subset within group</span>
<span class="go">-r REPEAT_ID, --repeat_id REPEAT_ID</span>
<span class="go">                        Repeat id (main if first time running, &lt;phase&gt;_&lt;repeat&gt; otherwise)</span>
<span class="go">-p PROJ_CODE, --proj_code PROJ_CODE</span>
<span class="go">                        Run for a specific project code, within a group or otherwise</span>
</pre></div>
</div>
</section>
<section id="phased-operation-flags">
<h3>Phased operation flags<a class="headerlink" href="#phased-operation-flags" title="Link to this heading"></a></h3>
<p>For <code class="docutils literal notranslate"><span class="pre">scan</span></code>, <code class="docutils literal notranslate"><span class="pre">compute</span></code> and <code class="docutils literal notranslate"><span class="pre">validate</span></code>, multiple flags exist to enable more complex configurations, including parallel deployment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">-f, --forceful        Force overwrite of steps if previously done</span>
<span class="go">-v, --verbose         Print helpful statements while running</span>
<span class="go">-d, --dryrun          Perform dry-run (i.e no new files/dirs created)</span>
<span class="go">-T, --thorough        Thorough processing - start from scratch</span>
<span class="go">-b BYPASS, --bypass-errs BYPASS</span>
<span class="go">                        Bypass switch options: &quot;D&quot; - * Skip driver failures - Pipeline tries different options for NetCDF (default). - Only need to turn this skip off if all drivers fail</span>
<span class="go">                        (KerchunkDriverFatalError). &quot;F&quot; - Skip scanning (fasttrack) and go straight to compute. Required if running compute before scan is attempted. &quot;L&quot; - Skip adding links in compute</span>
<span class="go">                        (download links) - this will be required on ingest. &quot;S&quot; - Skip errors when running a subset within a group. Record the error then move onto the next dataset.</span>
<span class="go">-C MODE, --cloud-format MODE</span>
<span class="go">                        Output format to be used.</span>
<span class="go">-t TIME_ALLOWED, --time-allowed TIME_ALLOWED</span>
<span class="go">                        Time limit for this job (parallel only)</span>
<span class="go">-M MEMORY, --memory MEMORY</span>
<span class="go">                        Memory allocation for this job (parallel only) (i.e &quot;2G&quot; for 2GB)</span>
<span class="go">-e VENVPATH, --environ VENVPATH</span>
<span class="go">                        Path to virtual (e)nvironment (excludes /bin/activate)</span>
<span class="go">-A, --alloc-bins      input file (for init phase)</span>
<span class="go">--xarray_kwargs XARRAY_KWARGS</span>
<span class="go">                        Supply kwargs for xarray, comma separated</span>
<span class="go">--parallel            Add for parallel deployment with SLURM</span>
<span class="go">--parallel_project PARALLEL_PROJECT</span>
<span class="go">                        Add for parallel deployment with SLURM for internal project conversion.</span>
<span class="go">--allow-band-increase</span>
<span class="go">                        Allow automatic banding increase relative to previous runs.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An optional first step involves creating an empty group in the workspace that can be properly initialised later.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>new<span class="w"> </span>-G<span class="w"> </span>my-new-group
</pre></div>
</div>
<p>There is no particular advantage to creating empty groups but this may be beneficial for organisation of multiple new groups where the data is still being collected, or indeed transferring existing projects to a new group.</p>
</div>
</section>
</section>
<section id="all-non-phased-operations">
<h2>All Non-Phased Operations<a class="headerlink" href="#all-non-phased-operations" title="Link to this heading"></a></h2>
<p>The following are accepted options to the <code class="docutils literal notranslate"><span class="pre">operation</span></code> argument, starting with operations that include custom flags, followed by the ones that don’t. Phased operation is detailed in the main user guide section of this documentation.</p>
<section id="add">
<h3>Add<a class="headerlink" href="#add" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>add<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>-i<span class="w"> </span>new_projects.csv
<span class="gp"># </span>Alternative
<span class="gp">$ </span>padocc<span class="w"> </span>add<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>-i<span class="w"> </span>new_projects.json<span class="w"> </span>--moles
</pre></div>
</div>
<p>The CLI-based add function takes either a new input CSV file from which to add projects, or a moles-based json file that comes from the CEDA CCI tagger module - CEDA staff use only. Note that the <code class="docutils literal notranslate"><span class="pre">moles</span></code> flag is specific to the <code class="docutils literal notranslate"><span class="pre">add</span></code> function, but the <code class="docutils literal notranslate"><span class="pre">-i</span></code> input file flag is shared by <code class="docutils literal notranslate"><span class="pre">init</span></code> and <code class="docutils literal notranslate"><span class="pre">validate</span></code>.</p>
</section>
<section id="complete">
<h3>Complete<a class="headerlink" href="#complete" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Complete<span class="w"> </span>whole<span class="w"> </span>group
<span class="gp">$ </span>padocc<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--completion_dir<span class="w"> </span>&lt;directory&gt;
<span class="gp"># </span>Complete<span class="w"> </span>individual<span class="w"> </span>project
<span class="gp">$ </span>padocc<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--completion_dir<span class="w"> </span>&lt;directory&gt;<span class="w"> </span>-p<span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<p>The final step in the pipeline is to complete each project, transferring a copy of the output products and reports to a directory outside the pipeline. When the <code class="docutils literal notranslate"><span class="pre">-T</span></code> thorough flag is used, this automatically converts kerchunk files to a <code class="docutils literal notranslate"><span class="pre">remote</span></code> version, which has <code class="docutils literal notranslate"><span class="pre">https://dap.ceda.ac.uk</span></code> links added to each kerchunk reference.</p>
<p>Additionally, using the <code class="docutils literal notranslate"><span class="pre">repeat_id</span></code> flag will enable completing subsets of a group. See the <code class="docutils literal notranslate"><span class="pre">repeat</span></code> section below. Note that any project selected for completion that is already complete will be skipped.</p>
</section>
<section id="get-log">
<h3>Get Log<a class="headerlink" href="#get-log" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>logs<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>-p<span class="w"> </span><span class="m">0</span><span class="w"> </span>--log_phase<span class="w"> </span>scan
</pre></div>
</div>
<p>Show the contents of a log from a given phase, specified using the <code class="docutils literal notranslate"><span class="pre">log_phase</span></code> flag which is unique to this operation. This can be used to extract a log for a specific project or all the projects in a given group, where the <code class="docutils literal notranslate"><span class="pre">-p</span></code> flag is omitted.</p>
</section>
<section id="repeat">
<h3>Repeat<a class="headerlink" href="#repeat" title="Link to this heading"></a></h3>
<p>Create a repeat subgroup with ID inside an existing group, based on selection criteria.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>repeat<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--new_repeat<span class="w"> </span>&lt;new_repeat_name&gt;<span class="w"> </span>--status<span class="w"> </span>ValueError<span class="w"> </span>--phase<span class="w"> </span>compute
</pre></div>
</div>
<p>The above will collect all projects in the <code class="docutils literal notranslate"><span class="pre">compute</span></code> phase where the <code class="docutils literal notranslate"><span class="pre">status</span></code> matches <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>. For all projects in a given phase, or across all phases for a given status, use <code class="docutils literal notranslate"><span class="pre">Any</span></code> as the value as appropriate.</p>
</section>
<section id="status">
<h3>Status<a class="headerlink" href="#status" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>status<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--long_display<span class="w"> </span>--display_upto<span class="w"> </span><span class="m">30</span>
</pre></div>
</div>
<p>Obtain a human-readable status display for a given group, complete with error messages and which project IDs are in which state. The <code class="docutils literal notranslate"><span class="pre">long_display</span></code> flag shows the entire error message without truncation, and <code class="docutils literal notranslate"><span class="pre">display_upto</span></code> specifies how many project IDs should be displayed with each error message. For errors with more than this number of projects, no project IDs will be displayed. The default display only shows up to 5 codes for a given error, but the above command will show up to 30.</p>
<p>Finally the <code class="docutils literal notranslate"><span class="pre">separate_errors</span> <span class="pre">(S)</span></code> flag separates successful and failed projects in the <code class="docutils literal notranslate"><span class="pre">validate</span></code> phase, with percentage values for how many have been successful/unsuccessful. An example output is below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Group: cmip_1</span>
<span class="go">Total Codes: 49</span>

<span class="go">Pipeline Current:</span>

<span class="go">scan      : 5     [10.2%] (Variety: 1)</span>
<span class="go">    - Fatal                                      : 5 (IDs = [16, 18, 20, 21, 22])</span>

<span class="go">compute   : 4     [8.2 %] (Variety: 1)</span>
<span class="go">    - Pending                                    : 4 (IDs = [33, 34, 35, 36])</span>

<span class="go">validate  : 40    [81.6%] (Variety: 8)</span>
<span class="go">    - Fatal-bypassed                             : 11 (IDs = [4, 5, 7, 8, 9, 11, 12, 13, 15, 19, 24])</span>
<span class="go">    - Success                                    : 11 (IDs = [0, 1, 2, 38, 39, 41, 43, 44, 46, 47, 48])</span>
<span class="go">    - Redo                                       : 6 (IDs = [25, 27, 28, 29, 30, 31])</span>
<span class="go">    - JobCancelled                               : 5 (IDs = [6, 10, 14, 17, 23])</span>
<span class="go">    - Fatal-data_errors                          : 3 (IDs = [40, 42, 45])</span>
<span class="go">    - Warn-global_branch_time_in_child_not_equal : 2 (IDs = [26, 32])</span>
<span class="go">    - Warn-rsds_history_not_equal                : 1 (IDs = [37])</span>
<span class="go">    - Warn-uas_history_not_equal                 : 1 (IDs = [3])</span>

<span class="go">Pipeline Complete:</span>

<span class="go">    complete  : 0     [0.0 %]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New messages representing the aggregation methods are now in place for validation status messages. These may be one of <code class="docutils literal notranslate"><span class="pre">(P&gt;VK)</span></code>, <code class="docutils literal notranslate"><span class="pre">(V&gt;K)</span></code> or <code class="docutils literal notranslate"><span class="pre">(K)</span></code> representing which aggregation method; PADOCC, VirtualiZarr or Kerchunk was used, and which should be attempted next in case of Validation failure and manual intervention. In future, this may be able to be utilised by SHEPARD to repeat the computation process for a dataset that has failed validation.</p>
</div>
</section>
<section id="transfer">
<h3>Transfer<a class="headerlink" href="#transfer" title="Link to this heading"></a></h3>
<p>Transfer a set of one or more projects from one group to another. Given the example status summary above, the projects corresponding to <code class="docutils literal notranslate"><span class="pre">Fatal-data_errors</span></code> may be moved into a different group (e.g quarantine) by first creating a <code class="docutils literal notranslate"><span class="pre">repeat_id</span></code>, or specifying the list of project codes for transfer. Both methods are shown below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>After<span class="w"> </span>using<span class="w"> </span><span class="sb">`</span>padocc<span class="w"> </span>repeat...<span class="sb">`</span>
<span class="gp">$ </span>padocc<span class="w"> </span>transfer<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;fatal_data_errors&gt;<span class="w"> </span>--new_group<span class="w"> </span>quarantine
<span class="gp"># </span>Alternative<span class="w"> </span>with<span class="w"> </span>project<span class="w"> </span>codes
<span class="gp">$ </span>padocc<span class="w"> </span>transfer<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>-p<span class="w"> </span><span class="m">40</span>,42,45<span class="w"> </span>--new_group<span class="w"> </span>quarantine
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The list of IDs output from the <code class="docutils literal notranslate"><span class="pre">status</span></code> function can now be copied directly to the above transfer command list of project codes.</p>
</div>
</section>
<section id="update-status">
<h3>Update Status<a class="headerlink" href="#update-status" title="Link to this heading"></a></h3>
<p>This can be used to update the current status message for one or more projects. Mostly useful for debugging, if the code has changed and you wish for certain projects to become eligible for SHEPARD to pick up again, the easiest option is just to reset the status message to an awaiting stage (i.e Redo).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>update_status<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--old_phase<span class="w"> </span>compute<span class="w"> </span>--old_status<span class="w"> </span>ValueError<span class="w"> </span>--new_status<span class="w"> </span>Redo
</pre></div>
</div>
</section>
<section id="aggregations">
<h3>Aggregations<a class="headerlink" href="#aggregations" title="Link to this heading"></a></h3>
<p>Get a summary of which aggregation method(s) are the ones that have been used for each project to produce the current set of outputs. This will not show where methods have been attempted and failed, but unless certain methods have been bypassed this will be the case anyway.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>aggregations<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;
</pre></div>
</div>
</section>
<section id="check-set-attributes">
<h3>Check/Set Attributes<a class="headerlink" href="#check-set-attributes" title="Link to this heading"></a></h3>
<p>Check an attribute across multiple projects in a group using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>check_attr<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--attr<span class="w"> </span>&lt;attribute&gt;
</pre></div>
</div>
<p>This will produce a listing of all project codes and the value of the attribute from the detail_cfg, base_cfg, or the main project attribute if it can be located.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>set_attr<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>--attr<span class="w"> </span>&lt;attribute&gt;<span class="w"> </span>--value<span class="w"> </span>&lt;value&gt;
</pre></div>
</div>
<p>Similarly the <code class="docutils literal notranslate"><span class="pre">set_attr</span></code> method enables setting a value for all projects in a group (or repeat_id subset), if the attribute is known to exist in the detail/base_cfg files or as a main project attribute.</p>
</section>
<section id="delete">
<h3>Delete<a class="headerlink" href="#delete" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>delete<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;<span class="w"> </span>-p<span class="w"> </span><span class="m">0</span>,1,2
</pre></div>
</div>
<p>Used to remove one or more projects from a specific group, or delete the group entirely if the project flag is omitted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user will always be prompted before deletion to confirm when using the command line interface. Interactively there is an argument to be provided to suppress confirmation - usually <code class="docutils literal notranslate"><span class="pre">ask=False</span></code></p>
</div>
</section>
<section id="list">
<h3>List<a class="headerlink" href="#list" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>list
<span class="go">Groups in &lt;WORKDIR&gt;</span>
<span class="go">&gt; group0: 10</span>
<span class="go">&gt; group1: 25</span>
</pre></div>
</div>
<p>The list function shows all groups in the current working directory and the total number of projects in each group.</p>
</section>
<section id="new">
<h3>New<a class="headerlink" href="#new" title="Link to this heading"></a></h3>
<p>Create a new group with no current content. This is different to initialising a new group as it does not require an input file. The main use case for creating an empty group is for transferring groups to a new location. Groups are an arbitrary container for multiple projects that mean parallel operations can be managed more easily.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>new<span class="w"> </span>-G<span class="w"> </span>&lt;new_group&gt;
</pre></div>
</div>
</section>
<section id="report">
<h3>Report<a class="headerlink" href="#report" title="Link to this heading"></a></h3>
<p>Obtain the report for a specific project within a group, or a combined report for the whole group.</p>
<p>For individual reports, include the project code of the given project.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>report<span class="w"> </span>-G<span class="w"> </span>&lt;new_group&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;proj_code&gt;
</pre></div>
</div>
<p>Or to obtain a combined report for the whole group, simply omit the project code. You may also specify the repeat ID to combine reports from a specific subset of the group.</p>
</section>
<section id="summarise">
<h3>Summarise<a class="headerlink" href="#summarise" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>padocc<span class="w"> </span>summarise<span class="w"> </span>-G<span class="w"> </span>&lt;group&gt;
</pre></div>
</div>
<p>Generates a summary of the data analysed in any given project, including the number of datasets compatible with analysis (have passed the scan phase and were not skipped.)</p>
<p>The summary includes the total number of native files as well as an estimate of the total dataset size and the cloud products. A reminder that each <code class="docutils literal notranslate"><span class="pre">project</span></code> usually produces a single cloud product.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Summary Report: cmip_1</span>
<span class="go">Project Codes Assessed: 23</span>

<span class="go">Source Files: 348 [Avg. 15.13 per project]</span>
<span class="go">Source Data: 447.10 GB [Avg. 19.44 GB per project]</span>
<span class="go">Cloud Data: 3.32 GB [Avg. 144.38 MB per project]</span>

<span class="go">Cloud Formats: [&#39;kerchunk&#39;]</span>
<span class="go">Source Formats: [&#39;ncf3&#39;, &#39;hdf5&#39;]</span>
<span class="go">File Types: [&#39;json&#39;]</span>

<span class="go">Chunks per File: 2538771.00 [Avg. 110381.35 per project]</span>
<span class="go">Total Chunks: 19884293.00 [Avg. 864534.48 per project]</span>
</pre></div>
</div>
</section>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h2>
<p>Cloud products that have been validated are moved to a <code class="docutils literal notranslate"><span class="pre">complete</span></code> directory with the project code as the name, plus the revision identifier <cite>abX.X</cite> - learn more about this in the Extra section.
These can then be linked to a catalog or ingested into the CEDA archive where appropriate.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="user_guide.html" class="btn btn-neutral float-left" title="Basic User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ceda_staff.html" class="btn btn-neutral float-right" title="Extra Details for CEDA Staff" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2024, Centre of Environmental Data Analysis Developers,Scientific and Technical Facilities Council (STFC),UK Research and Innovation (UKRI). BSD 2-Clause License. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #e92603;
    }

    .caption-text, .header h1 {
        color: #ef4d5a
    }

    .note {
        background: #BEEF9E
    }
    .admonition-title {
        background: #335145
    }

    .wy-nav-side {
        background: #001711;
    }

  </style>


</body>
</html>