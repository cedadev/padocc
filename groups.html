
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Groups in PADOCC &mdash; PADOCC Package v1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=3dd8cc91"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The SHEPARD Module" href="shepard.html" />
    <link rel="prev" title="Projects in PADOCC" href="projects.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PADOCC Package
              <img src="_static/padocc_wt.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="inspiration.html">Inspiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="phases.html">Steps to Run Padocc</a></li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="cci_water.html">Example Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep_dive.html">A Deep Dive</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-guide.html">Developer Guide - Adding new functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-guide.html#new-modes-in-assessor">1. New Modes in Assessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-guide.html#new-processors-for-compute">2. New Processors for Compute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Operations:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="projects.html">The Project Operator</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Group Operator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#instantiating-a-group">Instantiating a Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initialisation-from-a-file">Initialisation from a File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#applying-an-operation">Applying an operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merging-or-unmerging">Merging or Unmerging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shepard.html">SHEPARD</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PADOCC Source:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="project_source.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_source.html">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase_source.html">Phases</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_source.html">Filehandlers, Logs, and Utilities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PADOCC Package</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Groups in PADOCC</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/groups.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="groups-in-padocc">
<h1>Groups in PADOCC<a class="headerlink" href="#groups-in-padocc" title="Permalink to this heading"></a></h1>
<p>The advantage of using PADOCC over other tools for creating cloud-format files is the scalability built-in, with parallelisation and deployment in mind.
PADOCC allows the creation of groups of datasets, each with N source files, that can be operated upon as a single entity.
The operation can be applied to all or a subset of the datasets within the group with relative ease. Here we outline some basic functionality of the <code class="docutils literal notranslate"><span class="pre">GroupOperation</span></code>.
See the source documentation page for more detail.</p>
<section id="instantiating-a-group">
<h2>Instantiating a Group<a class="headerlink" href="#instantiating-a-group" title="Permalink to this heading"></a></h2>
<p>A group is most easily created using a python terminal or Jupyter notebook, with a similar form to the below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">padocc.operations</span> <span class="kn">import</span> <span class="n">GroupOperation</span>

<span class="n">my_group</span> <span class="o">=</span> <span class="n">GroupOperation</span><span class="p">(</span>
    <span class="s1">&#39;mygroup&#39;</span><span class="p">,</span>
    <span class="n">workdir</span><span class="o">=</span><span class="s1">&#39;path/to/dir&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<p>At the point of defining the group, all required files and folders are created on the file system with default
or initial values for some parameters. Further processing steps which incur changes to parameters will only be saved
upon completion of an operation. If in doubt, all files can be saved with current values using <code class="docutils literal notranslate"><span class="pre">.save_files()</span></code>
for the group.</p>
<p>This is a blank group with no attached parameters, so the initial values in all created files will be blank or templated
with default values. To fill the group with actual data, we need to initialise from an input file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the future it will be possible to instantiate from other file types or records (e.g STAC) but for now the accepted
format is a csv file, where each entry fits the format:
<code class="docutils literal notranslate"><span class="pre">project_code,</span> <span class="pre">/file/pattern/**/*.nc,</span> <span class="pre">/path/to/updates.json</span> <span class="pre">or</span> <span class="pre">empty,</span> <span class="pre">/path/to/removals.json</span> <span class="pre">or</span> <span class="pre">empty</span></code></p>
</div>
</section>
<section id="initialisation-from-a-file">
<h2>Initialisation from a File<a class="headerlink" href="#initialisation-from-a-file" title="Permalink to this heading"></a></h2>
<p>A group can be initialised from a CSV file using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_group</span><span class="o">.</span><span class="n">init_from_file</span><span class="p">(</span><span class="s1">&#39;/path/to/csv.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Substitutions can be provided here if necessary, of the format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">substitutions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;init_file&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;swap/this/for&#39;</span><span class="p">:</span><span class="s1">&#39;this&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;dataset_file&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;swap/that/for&#39;</span><span class="p">:</span><span class="s1">&#39;that&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;datasets&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;swap/that/for&#39;</span><span class="p">:</span><span class="s1">&#39;these&#39;</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>Where the respective sections relate to the following:</dt><dd><ul class="simple">
<li><p>Init file: Substitutions to the path to the provided CSV file</p></li>
<li><p>Dataset file: Substitutions in the CSV file, specifically with the paths to <code class="docutils literal notranslate"><span class="pre">.txt</span></code> files or patterns.</p></li>
<li><p>Datasets: Substitutions in the <code class="docutils literal notranslate"><span class="pre">.txt</span></code> file that lists each individual file in the dataset.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="applying-an-operation">
<h2>Applying an operation<a class="headerlink" href="#applying-an-operation" title="Permalink to this heading"></a></h2>
<p>Now we have an initialised group, in the same group instance we can apply an operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mygroup</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;kerchunk&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The operation/phase being applied is a positional argument and must be one of <code class="docutils literal notranslate"><span class="pre">scan</span></code>, <code class="docutils literal notranslate"><span class="pre">compute</span></code> or <code class="docutils literal notranslate"><span class="pre">validate</span></code>.
(<code class="docutils literal notranslate"><span class="pre">ingest/catalog</span></code> may be added with the full version 1.3). There are also several keyword arguments that can be applied here:</p>
<blockquote>
<div><ul class="simple">
<li><p>mode: The format to use for the operation (default is Kerchunk)</p></li>
<li><p>repeat_id: If subsets have been produced for this group, use the subset ID, otherwise this defaults to <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>proj_code: For running a single project code within the group instead of all groups.</p></li>
<li><p>subset: Used in combination with project code, if both are set they must be integers where the group is divided into <code class="docutils literal notranslate"><span class="pre">subset</span></code> sections, and this operation is concerned with the nth one given by <code class="docutils literal notranslate"><span class="pre">proj_code</span></code> which is now an integer.</p></li>
<li><p>bypass: BypassSwitch object for bypassing certain errors (see the Deep Dive section for more details)</p></li>
</ul>
</div></blockquote>
</section>
<section id="merging-or-unmerging">
<h2>Merging or Unmerging<a class="headerlink" href="#merging-or-unmerging" title="Permalink to this heading"></a></h2>
<p><strong>currently in development - alpha release</strong></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="projects.html" class="btn btn-neutral float-left" title="Projects in PADOCC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="shepard.html" class="btn btn-neutral float-right" title="The SHEPARD Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2024, Centre of Environmental Data Analysis Developers,Scientific and Technical Facilities Council (STFC),UK Research and Innovation (UKRI). BSD 2-Clause License. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #e92603;
    }

    .caption-text, .header h1 {
        color: #ef4d5a
    }

    .note {
        background: #BEEF9E
    }
    .admonition-title {
        background: #335145
    }

    .wy-nav-side {
        background: #001711;
    }

  </style>


</body>
</html>